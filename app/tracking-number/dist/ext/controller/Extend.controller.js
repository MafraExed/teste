sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/ui/model/json/JSONModel","sap/ui/core/format/NumberFormat"],function(t,e,a){"use strict";return t.extend("agr.fs.trackingnumber.ext.controller.Extend",{override:{onInit:function(){var t=this.base.getExtensionAPI().getModel()}},buscaDados:async function(t){let a;let n=new e;await n.loadData(t,null,true,"GET",false,true);a=n.getData();return a},formatQuantity:function(t,e){const n={maxFractionDigits:3,minFractionDigits:3,preserveDecimals:true,showMeasure:true};const i=a.getUnitInstance(n);return i.format(t,e)},formataData:function(t){let e=new Date(t);let a=`${String(e.getUTCDate()).padStart(2,"0")}/${String(e.getUTCMonth()+1).padStart(2,"0")}/${e.getUTCFullYear()}`;return a},onEdita:async function(){let t=this.base.getExtensionAPI().getSelectedContexts()[0].sPath;let a=this.base.getExtensionAPI().getModel().sServiceUrl;let n=a+t;let i=a;let s=a;try{let t=await this.buscaDados(n);t.requestedDeliveryDate=this.formataData(t.requestedDeliveryDate);t.fixedValueDate=this.formataData(t.fixedValueDate);i+="Contract/"+t.salesContract+"/"+t.salesContractItem;let a=await this.buscaDados(i);a.CreationDate=this.formataData(a.CreationDate);s+="Contract/"+t.intercompanySalesContract+"/"+t.intercompanySalesContractItem;let r=await this.buscaDados(s);r.CreationDate=this.formataData(r.CreationDate);let o=new e;let l={Editavel:false,Tracking:t,Contrato:a,InterCompanyContratoVenda:r,OrderType:[{key:"CLIENTE_FINAL",value:"Cliente Final"},{key:"ARMAZEM_MI",value:"Armazém Mercado Interno"},{key:"ARMAZEM_ME",value:"Armazém Mercado Externo"},{key:"IC_FINCUST",value:"FIN CUST"}]};o.setData(l);this.getView().setModel(o,"Aux");if(this.Editar){this.Editar.destroy()}this.Editar=sap.ui.xmlfragment("agr.fs.trackingnumber.ext.Fragmentos.Editar",this);this.getView().addDependent(this.Editar);this.Editar.open()}catch(t){sap.m.MessageBox.error("Erro")}},onCancelar:async function(){let t=this.base.getExtensionAPI().getSelectedContexts()[0].sPath;let a=this.base.getExtensionAPI().getModel().sServiceUrl;let n=a+t;try{let t=await this.buscaDados(n);if(t.processStatus!=="90"){sap.m.MessageBox.error("Não será permitido cancelar o Rastreio, pois existe Romaneio em andamento");return}let a=new e;let i={Editavel:false,Dados:t,Motivo:""};a.setData(i);this.getView().setModel(a,"Aux");if(this.Cancela){this.Cancela.destroy()}this.Cancela=sap.ui.xmlfragment("agr.fs.trackingnumber.ext.Fragmentos.Cancelar",this);this.getView().addDependent(this.Cancela);this.Cancela.open()}catch(t){}oModelAux.setData(objeto);this.getView().setModel(oModelAux,"Aux");if(this.Cancela){this.Cancela.destroy()}this.Cancela=sap.ui.xmlfragment("agr.fs.trackingnumber.ext.Fragmentos.Cancelar",this);this.getView().addDependent(this.Cancela);this.Cancela.open()},FechaEditar:function(){this.Editar.close();this.Editar.destroy()},FechaCancelar:function(){this.Cancela.close();this.Cancela.destroy()},onCancela:function(){let t=this.getView().getModel("Aux");let e=t.getData().Dados;let a=t.getData().Motivo},onSalvaEdicao:function(){let t=this.getView().getModel("Aux")}})});
//# sourceMappingURL=Extend.controller.js.map